var drExports;!function(){"use strict";window.wp.i18n,function(e){e(".js-select2").select2({closeOnSelect:!1,placeholder:delicious_recipes.search_placeholder,allowClear:!0});var t=null;e("body").on("change",".dr-search-field select",function(){var a={};e(".dr-search-field select option").each(function(){e(this).is(":selected")&&(a.hasOwnProperty(e(this).attr("name"))||(a[e(this).attr("name")]=[]),-1==e.inArray(this.value,a[e(this).attr("name")])&&a[e(this).attr("name")].push(this.value))});var s=e("#dr-search-nonce").val();null!==t&&t.abort(),t=jQuery.ajax({url:delicious_recipes.ajax_url,data:{action:"recipe_search_results",search:a,nonce:s},dataType:"json",type:"post",beforeSend:function(){e(".dr-search-item-wrap").addClass("dr-loading")},success:function(t){if(t.success){var a=wp.template("search-block-tmp");if(e(".dr-search-item-wrap").html(a(t.data.results)),e(".navigation.pagination .nav-links").addClass("dr-ajax-paginate").html(t.data.pagination),"AND"===t.data?.logic){if(e('.advance-search-options select.js-select2:not([name="sorting"]) option').each(function(t,a){e(this).text(e(a).data("title")+" (0)")}),t.data?.terms){var s=t.data.terms;if("object"==typeof s)for(var i in s)if("object"==typeof s[i])for(var r in s[i]){var n=s[i][r];e(`select[name="${i}"] option[value="${n.term_id}"]`).text(`${n.name} (${n.count})`)}}if(t.data?.metas){var o=t.data.metas;if("object"==typeof o)for(var c in o)for(var l in o[c]){var d=o[c][l],p=e(`select[name="${c}"] option[value="${l}"]`),u=p.data("title");p.text(`${u} (${d})`)}}e(".advance-search-options select.js-select2").select2({closeOnSelect:!1,placeholder:delicious_recipes.search_placeholder,allowClear:!0})}}},complete:function(){e(".dr-search-item-wrap").removeClass("dr-loading"),t=null}})}),e(document).on("click",".dr-ajax-paginate a.page-numbers",function(t){t.preventDefault();var a={};e(".dr-search-field select option").each(function(){e(this).is(":selected")&&(a.hasOwnProperty(e(this).attr("name"))||(a[e(this).attr("name")]=[]),-1==e.inArray(this.value,a[e(this).attr("name")])&&a[e(this).attr("name")].push(this.value))});var s=e("#dr-search-nonce").val();jQuery.ajax({url:delicious_recipes.ajax_url,data:{action:"recipe_search_results",search:a,nonce:s,paged:e(this).attr("href").split("=")[1]},dataType:"json",type:"post",beforeSend:function(){e(".dr-search-item-wrap").addClass("dr-loading")},success:function(t){if(t.success){var a=wp.template("search-block-tmp");e(".dr-search-item-wrap").html(a(t.data.results)),e(".navigation.pagination .nav-links").addClass("dr-ajax-paginate").html(t.data.pagination)}},complete:function(){e(".dr-search-item-wrap").removeClass("dr-loading")}})}),e("#dr-recipes-clear-filters").on("click",function(t){t.preventDefault(),e(".dr-advance-search .advance-search-options select").each(function(){e(this).val(null).trigger("change")})}),e(document).ready(function(){document.addEventListener("click",function(e){const t=e.target.closest(".dr-recipe-wishlist span.dr-bookmark-wishlist");if(!t)return;e.preventDefault();const a=t.getAttribute("data-recipe-id"),s=t.classList.contains("dr-wishlist-is-bookmarked")?"remove":"add";t.classList.add("loading");const i=new FormData;i.append("action","delicious_recipes_wishlist"),i.append("add_remove",s),i.append("recipe_id",a),fetch(delicious_recipes.ajax_url,{method:"POST",body:i}).then(e=>e.json()).then(e=>{if(e&&e.data){const a=t.querySelector(".dr-wishlist-total"),i=t.querySelector(".dr-wishlist-info");a&&(a.innerHTML=e.data.wishlists),i&&(i.innerHTML=e.data.message),e.data.isBookmarked||"add"===s?t.classList.add("dr-wishlist-is-bookmarked"):t.classList.remove("dr-wishlist-is-bookmarked")}}).finally(()=>{if(t.classList.remove("loading"),"undefined"!=typeof recipeProGlobal&&t.closest(".dr-floating-box .dr-add-to-wishlist-single .dr-recipe-wishlist")){const e=window.location.href,a=recipeProGlobal.filter(t=>t.path===e);a[0]&&(a[0].wishlist=t.closest(".dr-recipe-wishlist").innerHTML)}})}),function(){const e=document.querySelectorAll(".dr-recipe-wishlist span.dr-popup-user__registration");if(!e.length)return;const t=document.getElementById("dr-user__registration-login-popup");if(!t)return;e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),t.style.display="block"})});const a=document.querySelector(".dr-user__registration-login-popup-close");a&&(a.onclick=function(){t.style.display="none"}),window.addEventListener("click",function(e){e.target===t&&(t.style.display="none")});const s=document.querySelector("form[name='dr-form__log-in']");s&&s.addEventListener("submit",function(e){e.preventDefault();const t=s.querySelector('input[name="username"]').value,a=s.querySelector('input[name="password"]').value,i=s.querySelector('input[name="rememberme"]').value,r=s.querySelector('input[name="login"]').value,n=s.querySelector('input[name="delicious_recipes_user_login_nonce"]').value;s.classList.add("dr-loading");const o=document.querySelector(".delicious-recipes-success-msg"),c=document.querySelector(".delicious-recipes-error-msg");o&&(o.style.display="none"),c&&(c.style.display="none");const l=new FormData;l.append("action","delicious_recipes_process_login"),l.append("username",t),l.append("password",a),l.append("rememberme",i),l.append("login",r),l.append("delicious_recipes_user_login_nonce",n),l.append("calling_action","delicious_recipes_modal_login"),fetch(delicious_recipes.ajax_url,{method:"POST",body:l}).then(e=>e.json()).then(e=>{e.success?(document.querySelectorAll(".dr-recipe-wishlist > span").forEach(function(e){e.classList.remove("dr-popup-user__registration"),e.classList.add("dr-bookmark-wishlist")}),o&&(o.innerHTML=e.data.success,o.style.display="block"),location.reload()):c&&(c.innerHTML=e.data.error,c.style.display="block")}).finally(()=>{s.classList.remove("dr-loading")})})}()})}(jQuery),(drExports=void 0===drExports?{}:drExports).recipeSearch={}}();